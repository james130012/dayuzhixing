<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marin é¡¹ç›®æ·±åº¦è§£è¯»</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <style>
        /* General Styles */
        body {
            font-family: 'Nunito', 'Helvetica Neue', Helvetica, Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            line-height: 1.8;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa; /* Light gray background */
            color: #343a40; /* Darker text for better readability */
            font-size: 12pt; /* Default for screen, will be overridden for print */
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 25px;
            background-color: #ffffff; /* White content background */
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-radius: 12px;
        }

        /* Header */
        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, #4A90E2 0%, #50E3C2 100%); /* Lively gradient */
            color: white;
            border-radius: 12px 12px 0 0;
        }

        header h1 {
            margin: 0;
            font-size: 2.8em;
            font-weight: 700; /* Bolder */
            letter-spacing: 1px;
        }

        header p {
            margin-top: 8px;
            font-size: 1.2em;
            opacity: 0.9;
        }

        /* Navigation */
        nav {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            background-color: #e9ecef; /* Slightly darker gray for nav */
            padding: 12px 0;
            margin-bottom: 25px;
            border-bottom: 3px solid #4A90E2;
        }

        nav a {
            margin: 5px 15px;
            text-decoration: none;
            color: #0056b3; /* Stronger blue for links */
            font-weight: 600;
            padding: 8px 12px;
            border-radius: 6px;
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
        }

        nav a:hover {
            background-color: #4A90E2;
            color: white;
        }

        /* Section Titles */
        h2 {
            color: #D9534F; /* Lively red/orange */
            border-bottom: 3px solid #50E3C2; /* Complementary accent color */
            padding-bottom: 12px;
            margin-top: 35px;
            margin-bottom: 20px;
            font-size: 2em;
            font-weight: 600;
        }

        h3 {
            color: #5CB85C; /* Lively green */
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.6em;
            font-weight: 600;
        }

        /* Text and Lists */
        p, li {
            text-align: justify;
            margin-bottom: 1em;
            font-size: 1.05em; /* Slightly larger for readability */
        }

        ul, ol {
            padding-left: 25px;
        }

        /* Highlights and Code */
        strong, .highlight {
            color: #E67E22; /* Orange for emphasis */
            font-weight: bold;
        }

        code {
            background-color: #e9ecef;
            padding: 3px 6px;
            border-radius: 4px;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
            font-size: 0.95em;
        }

        .formula {
            display: block;
            text-align: center;
            padding: 12px;
            margin: 20px auto;
            background-color: #eef7ff; /* Light blue for formulas */
            border: 1px solid #cce0ff;
            border-left: 5px solid #4A90E2;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
            font-size: 1.15em;
            border-radius: 6px;
            width: fit-content;
            max-width: 90%;
            box-sizing: border-box;
        }

        /* Animation Containers */
        .animation-container {
            margin: 35px auto;
            padding: 20px;
            border: 1px solid #dee2e6; /* Lighter border */
            border-radius: 10px;
            background-color: #fdfdfd;
            text-align: center;
            overflow: hidden;
        }

        .animation-container h4 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #0056b3; /* Darker blue for animation titles */
            font-size: 1.3em;
            font-weight: 600;
        }

        canvas {
            display: block;
            margin: 10px auto;
            max-width: 100%;
            border-radius: 6px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        /* Specific canvas container styles */
        #dataPipelineCanvasContainer,
        #distributedTrainingCanvasContainer,
        #executorWorkflowCanvasContainer,
        #markdownConversionCanvasContainer,
        #modelTrainingLoopCanvasContainer {
            width: 100%;
            height: 380px; /* Adjusted default height */
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        /* Force specific height for actionCoverageCanvas if it exists */
        #actionCoverageCanvas {
             height: 350px !important; /* Example fixed height */
        }


        /* Buttons */
        button {
            background-color: #50E3C2; /* Accent color for buttons */
            color: white;
            border: none;
            padding: 12px 24px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 1em;
            font-weight: 500;
            margin: 12px 5px;
            cursor: pointer;
            border-radius: 6px;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        button:hover {
            background-color: #48CFAE; /* Darker shade on hover */
            transform: translateY(-1px);
        }
        button:active {
            transform: translateY(0px);
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 25px;
            margin-top: 35px;
            background-color: #343a40; /* Dark footer */
            color: #adb5bd; /* Lighter text for footer */
            font-size: 0.95em;
            border-radius: 0 0 12px 12px;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            body {
                font-size: 11pt;
            }
            header h1 {
                font-size: 2.2em;
            }
            header p {
                font-size: 1em;
            }
            h2 {
                font-size: 1.6em;
            }
            h3 {
                font-size: 1.3em;
            }
            nav a {
                margin: 5px 8px;
                padding: 6px 10px;
            }
            button {
                padding: 10px 18px;
                font-size: 0.95em;
            }
            .container {
                margin: 10px;
                padding: 15px;
            }
            #dataPipelineCanvasContainer,
            #distributedTrainingCanvasContainer,
            #executorWorkflowCanvasContainer,
            #markdownConversionCanvasContainer,
            #modelTrainingLoopCanvasContainer {
                height: 300px; /* Smaller height for mobile */
            }
        }

        /* A3 paper size, 16pt font, normal margins for printing */
        @media print {
            @page {
                size: A3;
                margin: 2.5cm; /* Ordinary page margin */
            }
            body {
                font-size: 16pt; /* ä¸‰å· font size (approx 16pt) */
                line-height: 1.6;
                background-color: #fff !important; /* White background for print */
                color: #000 !important; /* Black text for print */
                width: auto; /* Allow content to flow naturally */
                box-shadow: none;
            }
            .container {
                width: 100%;
                max-width: none;
                margin: 0;
                padding: 0;
                box-shadow: none;
                border-radius: 0;
            }
            header {
                background: none !important; /* No background color for print */
                color: #000 !important;
                border-bottom: 2px solid #000;
                padding: 20px 0;
            }
            header h1, header p {
                color: #000 !important;
            }
            nav {
                display: none; /* Hide navigation in print */
            }
            h2, h3 {
                color: #000 !important;
                border-color: #000 !important;
            }
            strong, .highlight {
                color: #000 !important; /* Black for print */
                font-weight: bold; /* Ensure boldness is kept */
            }
            code {
                background-color: #f0f0f0 !important; /* Light gray for code blocks */
                border: 1px solid #ccc;
            }
            .formula {
                background-color: #f0f0f0 !important;
                border: 1px solid #ccc;
                border-left: 3px solid #000 !important;
            }
            .animation-container {
                page-break-inside: avoid; /* Try to keep animations on one page */
                border: 1px solid #ccc !important;
                background-color: #fff !important;
            }
            canvas {
                border: 1px solid #999; /* Add border to canvas for print visibility */
            }
            button {
                display: none; /* Hide buttons in print */
            }
            footer {
                background: none !important;
                color: #000 !important;
                padding: 10px 0;
                border-top: 1px solid #000;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Marin é¡¹ç›®æ·±åº¦è§£è¯»ï¼šç‰©ç†ä¸é€»è¾‘çš„èˆªæµ·å›¾</h1>
            <p>ä¸€ä¸ªå¼€æºçš„åŸºç¡€æ¨¡å‹ç ”å‘æ¡†æ¶ï¼Œå¸¦ä½ æ¢ç´¢AIçš„æ˜Ÿè¾°å¤§æµ·</p>
        </header>

        <nav>
            <a href="#introduction">é¡¹ç›®æ¦‚è§ˆ</a>
            <a href="#physical-view">ç‰©ç†ç»“æ„</a>
            <a href="#logical-view">é€»è¾‘æµç¨‹</a>
            <a href="#animations-section">æ ¸å¿ƒåŠ¨ç”»æ¼”ç¤º</a>
            <a href="#conclusion">æ€»ç»“ä¸å±•æœ›</a>
        </nav>

        <section id="introduction">
            <h2><span class="highlight">ğŸš€</span> é¡¹ç›®æ¦‚è§ˆï¼šMarin ä¸ºä½•å¯èˆªï¼Ÿ</h2>
            <p>Marinï¼Œæ­£å¦‚å…¶åï¼Œå¯“æ„ç€åœ¨å¹¿é˜”çš„AIç ”ç©¶é¢†åŸŸä¸­èˆªè¡Œæ¢ç´¢ã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªä»£ç ä»“åº“ï¼Œæ›´æ˜¯ä¸€ä¸ª<strong class="highlight">ä»¥å¯å¤ç°æ€§ä¸ºæ ¸å¿ƒçš„å¼€æºåŸºç¡€æ¨¡å‹ç ”å‘æ¡†æ¶</strong>ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä»åŸå§‹æ•°æ®çš„èŒ«èŒ«å¤§æµ·ï¼Œåˆ°è®­ç»ƒå‡ºå¼ºå¤§çš„è¯­è¨€æ¨¡å‹ï¼ˆå¦‚Llamaã€DeepSeekã€Qwenç­‰ï¼‰ï¼ŒMarinä¸ºä½ æä¾›äº†åšå›ºçš„èˆ¹åªå’Œæ¸…æ™°çš„èˆªæµ·å›¾ã€‚å®ƒçš„ä½¿å‘½æ˜¯è®©æ•´ä¸ªç ”ç©¶è¿‡ç¨‹â€”â€”æ— è®ºæ˜¯æˆåŠŸçš„ä¹˜é£ç ´æµªï¼Œè¿˜æ˜¯å®è´µçš„ç»éªŒæ•™è®­â€”â€”éƒ½èƒ½å¤Ÿè¢«è®°å½•ã€åˆ†äº«å’Œå¤ç°ã€‚</p>
            <p>æ­¤é¡¹ç›®çš„æ ¸å¿ƒä»·å€¼åœ¨äºå…¶<strong class="highlight">å¯¹ç ”ç©¶å¼€å‘å…¨ç”Ÿå‘½å‘¨æœŸçš„è¦†ç›–</strong>ï¼šä»æµ·é‡æ•°æ®çš„æœé›†ä¸ç²¾ç‚¼ï¼ˆæ•°æ®çˆ¬å–ã€æ¸…æ´—ã€è½¬æ¢ã€å»é‡ã€åˆ†ç±»ï¼‰ï¼Œåˆ°é«˜æ•ˆçš„è¯å…ƒåŒ–ï¼ˆTokenizationï¼‰ï¼Œå†åˆ°å¯æ‰©å±•çš„æ¨¡å‹è®­ç»ƒï¼ˆæ”¯æŒTPUé›†ç¾¤å’Œå¤šèŠ‚ç‚¹GPUï¼‰ï¼Œä»¥åŠæœ€ç»ˆä¸¥è°¨çš„æ¨¡å‹è¯„ä¼°ã€‚Marinä¸ä»…ä»…æ˜¯å·¥å…·çš„å †ç Œï¼Œå®ƒé€šè¿‡ç²¾å¿ƒè®¾è®¡çš„<strong class="highlight">â€œæ‰§è¡Œå™¨ï¼ˆExecutorï¼‰â€</strong>å’Œ<strong class="highlight">â€œå®éªŒï¼ˆExperimentï¼‰â€</strong>æ¦‚å¿µï¼Œå°†è¿™äº›å¤æ‚çš„æ­¥éª¤ä¸²è”èµ·æ¥ï¼Œå½¢æˆäº†ä¸€å¥—æ ‡å‡†åŒ–çš„ã€å¯é…ç½®çš„å·¥ä½œæµã€‚</p>
            <p>æ ¹æ®é¡¹ç›®æ–‡æ¡£å’Œä»£ç ç»“æ„ï¼ŒMarinè‡´åŠ›äºè§£å†³å½“å‰å¤§æ¨¡å‹ç ”å‘ä¸­çš„å‡ ä¸ªç—›ç‚¹ï¼š</p>
            <ul>
                <li><strong>å¯å¤ç°æ€§éš¾é¢˜ï¼š</strong> ç¡®ä¿å®éªŒç»“æœçš„ä¸€è‡´æ€§å’Œå¯éªŒè¯æ€§ï¼Œè®°å½•ä»æ•°æ®åˆ°æ¨¡å‹çš„æ¯ä¸€æ­¥ã€‚</li>
                <li><strong>æ•°æ®å¤„ç†çš„å¤æ‚æ€§ï¼š</strong> æä¾›ä»åŸå§‹ç½‘é¡µã€å­¦æœ¯è®ºæ–‡ã€ä»£ç åº“ç­‰å¤šç§æ¥æºè·å–ã€å¤„ç†å’Œâ€œMarkdownåŒ–â€æ•°æ®çš„èƒ½åŠ›ï¼Œå¹¶é€šè¿‡â€œDatashopâ€ä¿ƒè¿›é«˜è´¨é‡æ•°æ®é›†çš„æ„å»ºä¸å…±äº«ã€‚</li>
                <li><strong>è®­ç»ƒä¸è¯„ä¼°çš„æ ‡å‡†åŒ–ï¼š</strong> æä¾›ç»Ÿä¸€çš„æ¥å£å’Œé…ç½®æ–¹å¼æ¥è¿è¡Œè®­ç»ƒä»»åŠ¡å’Œå¤šç»´åº¦è¯„ä¼°æ¨¡å‹æ€§èƒ½ã€‚</li>
                <li><strong>èµ„æºç®¡ç†çš„çµæ´»æ€§ï¼š</strong> æ”¯æŒåœ¨ä¸åŒç¡¬ä»¶ï¼ˆCPUã€GPUã€TPUï¼‰å’Œé›†ç¾¤ç¯å¢ƒï¼ˆå¦‚ä½¿ç”¨Rayè¿›è¡Œåˆ†å¸ƒå¼è®¡ç®—ï¼‰ä¸­é«˜æ•ˆæ‰§è¡Œä»»åŠ¡ã€‚</li>
            </ul>
            <p>ç®€è€Œè¨€ä¹‹ï¼ŒMarinå¸Œæœ›æˆä¸ºç ”ç©¶è€…ä»¬æ¢ç´¢åŸºç¡€æ¨¡å‹å‰æ²¿çš„å¾—åŠ›åŠ©æ‰‹ï¼Œè®©â€œç‚¼ä¸¹â€è¿‡ç¨‹æ›´åŠ ç§‘å­¦ã€é€æ˜å’Œé«˜æ•ˆã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»ç‰©ç†ç»“æ„å’Œé€»è¾‘æµç¨‹ä¸¤ä¸ªç»´åº¦ï¼Œæ·±å…¥å‰–æMarinçš„å†…åœ¨æœºåˆ¶ã€‚</p>
        </section>

        <section id="physical-view">
            <h2><span class="highlight">ğŸ—ï¸</span> ç‰©ç†ç»“æ„ï¼šMarin çš„â€œèˆ¹ä½“â€æ˜¯å¦‚ä½•æ„å»ºçš„ï¼Ÿ</h2>
            <p>ä»ç‰©ç†å±‚é¢çœ‹ï¼ŒMariné¡¹ç›®åƒä¸€è‰˜ç²¾å¿ƒè®¾è®¡çš„æ¨¡å—åŒ–ç§‘è€ƒèˆ¹ï¼Œå„ä¸ªèˆ±å®¤ï¼ˆç›®å½•ï¼‰åŠŸèƒ½æ˜ç¡®ï¼ŒååŒå·¥ä½œã€‚å…¶ä»£ç åº“ä¸»è¦ç”±ä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒéƒ¨åˆ†ç»„æˆï¼š</p>
            <ul>
                <li><code>marin/</code>: è¿™æ˜¯é¡¹ç›®çš„æ ¸å¿ƒå¼•æ“å®¤ï¼ŒåŒ…å«äº†å®ç°æ¡†æ¶ä¸»è¦åŠŸèƒ½çš„Pythonæ¨¡å—ã€‚
                    <ul>
                        <li><code>core/</code>: å®šä¹‰äº†åŸºç¡€æ•°æ®ç»“æ„ï¼ˆå¦‚å¯¹è¯æ ¼å¼<code>Conversation</code>ï¼‰ã€è¿è¡Œæ—¶ç¯å¢ƒå’Œæ ¸å¿ƒæ•°æ®å¤„ç†é€»è¾‘ã€‚</li>
                        <li><code>processing/</code>: æ•°æ®å¤„ç†ä¸­æ¢ï¼ŒåŒ…æ‹¬<strong class="highlight">åˆ†ç±»å™¨è®­ç»ƒä¸åº”ç”¨</strong>ï¼ˆå¦‚BERTã€FastTextè¿›è¡Œè´¨é‡åˆ†ç±»ã€ä¸»é¢˜åˆ†ç±»ç­‰ï¼‰ã€<strong class="highlight">è¯å…ƒåŒ–</strong>ï¼ˆ<code>tokenize.py</code>ï¼Œå°†æ–‡æœ¬è½¬æ¢ä¸ºæ¨¡å‹å¯ç†è§£çš„æ•°å­—åºåˆ—ï¼‰ã€ä»¥åŠé’ˆå¯¹ç‰¹å®šæ•°æ®æºï¼ˆå¦‚OpenWebMathã€PubMedã€Wikipediaï¼‰çš„ä¸“ç”¨å¤„ç†è„šæœ¬ã€‚</li>
                        <li><code>markdown/</code>: <strong class="highlight">HTMLåˆ°Markdownè½¬æ¢çš„æ ¸å¿ƒ</strong>ï¼ˆ<code>markdown.py</code>ï¼‰ï¼Œè‡´åŠ›äºä»å¤æ‚çš„ç½‘é¡µç»“æ„ä¸­æå–å¹²å‡€ã€ç»“æ„åŒ–çš„æ–‡æœ¬å†…å®¹ï¼Œè¿™æ˜¯Marinæ•°æ®é¢„å¤„ç†çš„ä¸€å¤§ç‰¹è‰²ã€‚Snapshotæµ‹è¯•ï¼ˆ<code>tests/snapshots/</code>ï¼‰ä¹Ÿå¤§é‡éªŒè¯äº†è¿™éƒ¨åˆ†åŠŸèƒ½çš„é²æ£’æ€§ã€‚</li>
                        <li><code>crawl/</code>: è´Ÿè´£ä»ç½‘ç»œä¸Šâ€œæ•æâ€åŸå§‹æ•°æ®ï¼Œæ”¯æŒä»é“¾æ¥åˆ—è¡¨è·å–å†…å®¹ï¼Œå¹¶åŒ…å«å¯¹ç‰¹å®šæ•°æ®é›†ï¼ˆå¦‚FineWeb-Edu, OpenWebMathï¼‰çš„çˆ¬å–é€»è¾‘ã€‚</li>
                        <li><code>training/</code>: æ¨¡å‹è®­ç»ƒçš„å¿ƒè„åœ°å¸¦ï¼Œå®šä¹‰äº†è®­ç»ƒæµç¨‹ï¼ˆ<code>training.py</code>ï¼‰ã€è®­ç»ƒé…ç½®ï¼Œå¹¶å¯èƒ½é›†æˆäº†åƒLevanterè¿™æ ·çš„JAXè®­ç»ƒåº“ï¼ˆä»è¯„ä¼°è„šæœ¬ä¸­å¯è§ç«¯å€ªï¼‰ã€‚</li>
                        <li><code>evaluation/</code>: æ¨¡å‹çš„â€œè¯•é‡‘çŸ³â€ï¼Œé›†æˆäº†å¤šç§è¯„ä¼°æ¡†æ¶ï¼ˆå¦‚LM Eval Harness, AlpacaEval, HELMï¼‰å’Œè¯„ä¼°ä»»åŠ¡é…ç½®ï¼Œç”¨äºå…¨é¢è¡¡é‡æ¨¡å‹æ€§èƒ½ã€‚</li>
                        <li><code>execution/</code>: <strong class="highlight">å®éªŒæ‰§è¡Œå™¨ï¼ˆ<code>executor.py</code>ï¼‰æ‰€åœ¨åœ°</strong>ï¼Œè´Ÿè´£è§£æå®éªŒé…ç½®ï¼Œç®¡ç†ä»»åŠ¡ä¾èµ–ï¼Œå¹¶åœ¨ä¸åŒåç«¯ï¼ˆæœ¬åœ°ã€Rayé›†ç¾¤ï¼‰è°ƒåº¦æ‰§è¡Œã€‚</li>
                        <li><code>datashop/</code>: ä½“ç°äº†Marinå¯¹æ•°æ®å…±äº«å’Œåä½œçš„é‡è§†ï¼Œæä¾›äº†å¤„ç†å’Œç»„ç»‡æ•°æ®é›†çš„å·¥å…·å’Œæµç¨‹ã€‚</li>
                        <li><code>operations/</code>: åŒ…å«äº†ä¸€ç³»åˆ—ç”¨äºæ•°æ®ä¸‹è½½ï¼ˆ<code>download/</code>ï¼‰ã€åŸå§‹æ•°æ®åˆ°JSONè½¬æ¢ï¼ˆ<code>raw2json/</code>ï¼‰ã€æ•°æ®æ ¼å¼è½¬æ¢ï¼ˆ<code>transform/</code>ï¼‰å’Œæ•°æ®éªŒè¯ï¼ˆ<code>validate/</code>ï¼‰çš„æ“ä½œè„šæœ¬ï¼Œæ˜¯æ•°æ®å‡†å¤‡æµæ°´çº¿çš„å…·ä½“å®ç°ã€‚</li>
                        <li><code>utilities/</code>: æä¾›å„ç§å®ç”¨å·¥å…·å‡½æ•°ï¼Œå¦‚GCSäº‘å­˜å‚¨äº¤äº’ã€Hugging Face Hubæ“ä½œã€WandBæ—¥å¿—è®°å½•ç­‰ã€‚</li>
                    </ul>
                </li>
                <li><code>experiments/</code>: è¿™é‡Œæ˜¯â€œå®éªŒç”²æ¿â€ï¼Œå­˜æ”¾äº†å¤§é‡çš„å®éªŒé…ç½®æ–‡ä»¶å’Œè¿è¡Œè„šæœ¬ã€‚æ¯ä¸ªå­ç›®å½•é€šå¸¸ä»£è¡¨ä¸€ä¸ªæˆ–ä¸€ç³»åˆ—ç›¸å…³çš„å®éªŒï¼ˆä¾‹å¦‚<code>expXXX_*.py</code>ï¼‰ï¼Œå®šä¹‰äº†æ¨¡å‹æ¶æ„ã€æ•°æ®é›†ã€è®­ç»ƒå‚æ•°ç­‰ã€‚<code>hello_world.py</code>å’Œ<code>train_tiny_model_gpu.py</code>æ˜¯å¾ˆå¥½çš„å…¥é—¨ç¤ºä¾‹ã€‚</li>
                <li><code>docs/</code>: é¡¹ç›®çš„â€œèˆªæµ·æ—¥å¿—â€å’Œâ€œæ“ä½œæ‰‹å†Œâ€ï¼Œä½¿ç”¨MkDocsæ„å»ºï¼Œè¯¦ç»†ä»‹ç»äº†é¡¹ç›®ç†å¿µã€ä½¿ç”¨æ•™ç¨‹ã€æ ¸å¿ƒæ¦‚å¿µè§£é‡Šï¼ˆå¦‚LM Pipeline, Executor, Datashopï¼‰å’Œæ¨¡å‹æŠ¥å‘Šã€‚</li>
                <li><code>infra/</code>: åŸºç¡€è®¾æ–½é…ç½®ï¼Œä¸»è¦æ˜¯Rayé›†ç¾¤çš„YAMLé…ç½®æ–‡ä»¶ï¼Œé’ˆå¯¹ä¸åŒäº‘åŒºåŸŸï¼ˆå¦‚GCPçš„us-central1, eu-west4ç­‰ï¼‰å’Œç¡¬ä»¶ï¼ˆTPU, GPUï¼‰è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä½“ç°äº†é¡¹ç›®å¯¹<strong class="highlight">å¤§è§„æ¨¡åˆ†å¸ƒå¼è®¡ç®—</strong>çš„æ”¯æŒã€‚</li>
                <li><code>.github/</code>: åŒ…å«GitHubç‰¹å®šçš„é…ç½®æ–‡ä»¶ï¼Œå¦‚Issueæ¨¡æ¿å’Œ<strong class="highlight">GitHub Actionså·¥ä½œæµï¼ˆ<code>workflows/</code>ï¼‰</strong>ï¼Œç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€æ–‡æ¡£æ„å»ºã€ä»£ç è§„èŒƒæ£€æŸ¥ç­‰ï¼Œä¿è¯äº†é¡¹ç›®çš„å·¥ç¨‹è´¨é‡ã€‚</li>
                <li><code>tests/</code>: å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œå¿«ç…§æµ‹è¯•ï¼ˆSnapshot Testsï¼‰ï¼Œç¡®ä¿ä»£ç çš„æ­£ç¡®æ€§å’Œç¨³å®šæ€§ï¼Œç‰¹åˆ«æ˜¯<code>markdown/</code>å’Œå„ç§æ•°æ®å¤„ç†æ¨¡å—çš„æµ‹è¯•è¦†ç›–è¾ƒä¸ºå…¨é¢ã€‚</li>
                <li><code>data_browser/</code>: ä¸€ä¸ªåŸºäºReactå’ŒFlaskçš„Webåº”ç”¨ï¼Œç”¨äº<strong class="highlight">æµè§ˆå’Œå¯è§†åŒ–å®éªŒæ•°æ®</strong>ï¼Œæä¾›äº†ç›´è§‚çš„æ•°æ®æ´å¯Ÿç•Œé¢ã€‚å…¶<code>Dockerfile</code>å’Œ<code>docker-compose.yml</code>è¡¨æ˜å®ƒå¯ä»¥é€šè¿‡å®¹å™¨åŒ–éƒ¨ç½²ã€‚</li>
            </ul>
            <p>åœ¨æŠ€æœ¯é€‰å‹ä¸Šï¼ŒMarinä»¥Pythonä¸ºä¸»è¦å¼€å‘è¯­è¨€ï¼Œæ·±åº¦æ•´åˆäº†<strong class="highlight">Ray</strong>ç”¨äºåˆ†å¸ƒå¼ä»»åŠ¡æ‰§è¡Œï¼Œåˆ©ç”¨JAXè¿›è¡Œé«˜æ€§èƒ½è®¡ç®—ï¼ˆå°¤å…¶æ˜¯åœ¨TPUä¸Šï¼‰ã€‚æ•°æ®å­˜å‚¨å¹¿æ³›ä¾èµ–Google Cloud Storage (GCS)ã€‚ç‰ˆæœ¬æ§åˆ¶ã€åä½œå’ŒCI/CDåˆ™å®Œå…¨ä¾æ‰˜GitHubå¹³å°ã€‚è¿™ç§ç‰©ç†ç»“æ„çš„åˆ’åˆ†ï¼Œä½¿å¾—é¡¹ç›®æ—¢èƒ½ä¿æŒæ ¸å¿ƒåº“çš„ç¨³å®šä¸é€šç”¨ï¼Œåˆèƒ½çµæ´»æ”¯æŒå„ç§å®šåˆ¶åŒ–çš„å®éªŒç ”ç©¶ã€‚</p>
        </section>

        <section id="logical-view">
            <h2><span class="highlight">ğŸ—ºï¸</span> é€»è¾‘æµç¨‹ï¼šMarin å¦‚ä½•å¼•é¢†æ¨¡å‹ç ”å‘çš„èˆªç¨‹ï¼Ÿ</h2>
            <p>Marinçš„é€»è¾‘æ ¸å¿ƒæ˜¯ä¸€å¥—<strong class="highlight">ç«¯åˆ°ç«¯ã€å¯é…ç½®ã€å¯å¤ç°çš„åŸºç¡€æ¨¡å‹ç ”å‘æµæ°´çº¿</strong>ã€‚è¿™æ¡æµæ°´çº¿ä»åŸå§‹æ•°æ®çš„æ”¶é›†å¼€å§‹ï¼Œä¸€ç›´å»¶ä¼¸åˆ°æ¨¡å‹çš„è¯„ä¼°å’Œéƒ¨ç½²ï¼Œæ¯ä¸€ä¸ªç¯èŠ‚éƒ½ç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œå¹¶é€šè¿‡â€œå®éªŒâ€è¿™ä¸€æ¦‚å¿µè¿›è¡Œç»„ç»‡å’Œé©±åŠ¨ã€‚</p>

            <h3>1. æ ¸å¿ƒç†å¿µï¼šå®éªŒé©±åŠ¨ä¸å¯å¤ç°æ€§</h3>
            <p>Marinçš„ä¸€åˆ‡éƒ½å›´ç»•ç€<strong class="highlight">â€œå®éªŒï¼ˆExperimentï¼‰â€</strong>å±•å¼€ã€‚ä¸€ä¸ªå®éªŒé€šå¸¸å®šä¹‰åœ¨<code>experiments/</code>ç›®å½•ä¸‹çš„ä¸€ä¸ªPythonè„šæœ¬ä¸­ï¼Œå®ƒæè¿°äº†ä¸€ä¸ªå®Œæ•´çš„æ¨¡å‹ç ”å‘æµç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®å¤„ç†ã€æ¨¡å‹è®­ç»ƒå’Œè¯„ä¼°ç­‰æ­¥éª¤ã€‚è¿™äº›æ­¥éª¤åƒMakefileä¸­çš„ç›®æ ‡ä¸€æ ·ï¼Œå…·æœ‰ä¾èµ–å…³ç³»ï¼Œç”±Marinçš„<strong class="highlight">æ‰§è¡Œå™¨ï¼ˆExecutorï¼‰</strong>æŒ‰æ‹“æ‰‘é¡ºåºæ‰§è¡Œã€‚è¿™ç§è®¾è®¡ç¡®ä¿äº†ï¼š</p>
            <ul>
                <li><strong>æ¸…æ™°æ€§ï¼š</strong> æ¯ä¸ªå®éªŒçš„æµç¨‹å’Œé…ç½®éƒ½ä¸€ç›®äº†ç„¶ã€‚</li>
                <li><strong>æ¨¡å—åŒ–ï¼š</strong> å¯ä»¥å¤ç”¨å’Œç»„åˆä¸åŒçš„å¤„ç†æ­¥éª¤ã€‚</li>
                <li><strong>å¯å¤ç°æ€§ï¼š</strong> é€šè¿‡ç‰ˆæœ¬æ§åˆ¶ä»£ç ã€æ•°æ®å’Œé…ç½®ï¼Œä»¥åŠè®°å½•æ‰€æœ‰ä¸­é—´äº§ç‰©å’Œæ—¥å¿—ï¼ˆå¦‚ä½¿ç”¨WandBï¼‰ï¼ŒMarinåŠ›æ±‚è¾¾åˆ°å­—èŠ‚çº§åˆ«çš„å¯å¤ç°æ€§ã€‚</li>
            </ul>

            <h3>2. æ•°æ®å¤„ç†çš„â€œé©¬å…­ç”²æµ·å³¡â€ï¼šä»åŸå§‹åˆ°ç²¾ç‚¼</h3>
            <p>æ•°æ®æ˜¯é©±åŠ¨å¤§æ¨¡å‹çš„ç‡ƒæ–™ï¼ŒMarinåœ¨æ•°æ®å¤„ç†ä¸ŠæŠ•å…¥äº†å·¨å¤§ç²¾åŠ›ï¼š</p>
            <ul>
                <li><strong>æ•°æ®è·å–ï¼ˆData Acquisitionï¼‰ï¼š</strong> é€šè¿‡<code>marin/crawl/</code>å’Œ<code>operations/download/</code>æ¨¡å—ï¼Œæ”¯æŒä»å¤šç§æ¥æºè·å–æ•°æ®ï¼ŒåŒ…æ‹¬å…¬å¼€æ•°æ®é›†ï¼ˆå¦‚The Pile, C4, Dolmaï¼‰ã€ç½‘é¡µçˆ¬å–ã€ArXivè®ºæ–‡ã€Wikipediaã€StackExchangeé—®ç­”ç­‰ã€‚</li>
                <li><strong>æ•°æ®è½¬æ¢ä¸æ¸…æ´—ï¼ˆTransformation & Cleaningï¼‰ï¼š</strong> è¿™æ˜¯Marinçš„äº®ç‚¹ä¹‹ä¸€ã€‚<code>marin/markdown/</code>æ¨¡å—ä¸“æ³¨äºå°†åŸå§‹HTMLå†…å®¹ï¼ˆå°¤å…¶æ˜¯æ¥è‡ªç½‘é¡µå’ŒArXivï¼‰è½¬æ¢ä¸º<strong class="highlight">ç»“æ„åŒ–çš„Markdownæ ¼å¼</strong>ï¼Œå»é™¤æ— å…³å…ƒç´ ï¼Œä¿ç•™æ ¸å¿ƒæ–‡æœ¬å’Œç»“æ„ä¿¡æ¯ã€‚<code>operations/transform/</code>ä¸‹æœ‰å¤§é‡é’ˆå¯¹ç‰¹å®šæ•°æ®æºçš„è½¬æ¢è„šæœ¬ã€‚æ¸…æ´—è¿‡ç¨‹è¿˜åŒ…æ‹¬å»é‡ï¼ˆå¦‚ä½¿ç”¨MinHashï¼‰ã€è¿‡æ»¤ä½è´¨é‡å†…å®¹ï¼ˆé€šè¿‡FastTextæˆ–BERTåˆ†ç±»å™¨ï¼‰ã€å»é™¤æœ‰å®³ä¿¡æ¯ç­‰ã€‚</li>
                <li><strong>æ•°æ®æ ‡æ³¨ä¸åˆ†ç±»ï¼ˆAnnotation & Classificationï¼‰ï¼š</strong> <code>marin/processing/classification/</code>æ¨¡å—è®­ç»ƒå’Œä½¿ç”¨åˆ†ç±»å™¨ï¼ˆå¦‚åŸºäºBERTæˆ–FastTextï¼‰å¯¹æ•°æ®è¿›è¡Œè´¨é‡è¯„ä¼°ã€ä¸»é¢˜åˆ†ç±»ã€ä»£ç /æ–‡æœ¬åŒºåˆ†ç­‰ï¼Œä¸ºåç»­çš„æ•°æ®ç­›é€‰å’Œæ··åˆæä¾›ä¾æ®ã€‚</li>
                <li><strong>è¯å…ƒåŒ–ï¼ˆTokenizationï¼‰ï¼š</strong> ä½¿ç”¨<code>marin/processing/tokenize/</code>å°†æ¸…æ´—åçš„æ–‡æœ¬æ•°æ®è½¬æ¢ä¸ºæ¨¡å‹è®­ç»ƒæ‰€éœ€çš„è¯å…ƒåºåˆ—ã€‚æ”¯æŒå¤šç§åˆ†è¯å™¨ï¼Œå¹¶å¼ºè°ƒä¸Llamaç­‰ä¸»æµæ¨¡å‹å…¼å®¹ã€‚</li>
                <li><strong>æ•°æ®é›†æ„å»ºä¸ç®¡ç†ï¼ˆDatashopï¼‰ï¼š</strong> <code>marin/datashop/</code>å’Œç›¸å…³æ–‡æ¡£æå‡ºäº†â€œDatashopâ€æ¦‚å¿µï¼Œæ—¨åœ¨æä¾›ä¸€ä¸ªç³»ç»ŸåŒ–çš„æ–¹æ³•æ¥åˆ›å»ºã€ç‰ˆæœ¬åŒ–ã€æ··åˆå’Œå…±äº«é«˜è´¨é‡çš„è®­ç»ƒæ•°æ®é›†ã€‚è¿™åŒ…æ‹¬å®šä¹‰æ•°æ®é›†çš„Schemaã€å¤„ç†æµç¨‹å’Œå…ƒæ•°æ®ã€‚</li>
            </ul>
            <p class="formula">æ•°æ®è´¨é‡æå‡å…¬å¼ (æ¦‚å¿µæ€§): é«˜è´¨é‡æ•°æ® = (åŸå§‹æ•°æ® + ç²¾ç»†æ¸…æ´— + æ™ºèƒ½è¿‡æ»¤ + ç»“æ„åŒ–è½¬æ¢) * æœ‰æ•ˆå»é‡</p>

            <h3>3. æ¨¡å‹è®­ç»ƒçš„â€œå¼•æ“æ ¸å¿ƒâ€ï¼šå¯æ‰©å±•ä¸é«˜æ•ˆ</h3>
            <p>Marinçš„è®­ç»ƒæ¨¡å—ï¼ˆä¸»è¦åœ¨<code>marin/training/</code>å’Œ<code>experiments/</code>ä¸­çš„è„šæœ¬ï¼‰æ”¯æŒè®­ç»ƒå„ç§è§„æ¨¡çš„è¯­è¨€æ¨¡å‹ï¼š</p>
            <ul>
                <li><strong>æ¨¡å‹æ¶æ„ï¼š</strong> æ”¯æŒå¤šç§Transformerå˜ä½“ï¼Œå¦‚Llamaæ¶æ„ï¼ˆåœ¨<code>experiments/llama.py</code>å’Œæ¨¡å‹æŠ¥å‘Šä¸­æ˜ç¡®æåŠï¼‰ã€BERTã€æ··åˆä¸“å®¶æ¨¡å‹ï¼ˆMoEï¼‰ç­‰ã€‚æ¨¡å‹é…ç½®çµæ´»ï¼Œå…è®¸ç ”ç©¶äººå‘˜è°ƒæ•´å±‚æ•°ã€éšè—å±‚ç»´åº¦ã€æ³¨æ„åŠ›å¤´ç­‰å‚æ•°ã€‚</li>
                <li><strong>è®­ç»ƒæ¡†æ¶ï¼š</strong> ä¸»è¦åŸºäºPythonï¼Œå¹¶æ·±åº¦æ•´åˆäº†<strong class="highlight">JAX</strong>ï¼ˆå°¤å…¶é’ˆå¯¹TPUä¼˜åŒ–ï¼‰å’Œ<strong class="highlight">Ray</strong>ï¼ˆç”¨äºåˆ†å¸ƒå¼è®­ç»ƒï¼‰ã€‚è¿™ä½¿å¾—Marinèƒ½å¤Ÿé«˜æ•ˆåˆ©ç”¨å¤§è§„æ¨¡è®¡ç®—é›†ç¾¤ã€‚</li>
                <li><strong>ä¼˜åŒ–å™¨ä¸å­¦ä¹ ç‡ç­–ç•¥ï¼š</strong> æ”¯æŒAdamWç­‰å¸¸è§ä¼˜åŒ–å™¨ï¼Œå¹¶å¯é…ç½®å¤æ‚çš„å­¦ä¹ ç‡è°ƒåº¦ç­–ç•¥ï¼ˆå¦‚warmupã€decayï¼‰ã€‚ç›¸å…³é…ç½®è§äºå„ç±»å®éªŒè„šæœ¬ï¼Œå¦‚<code>experiments/exp725_adamwsweep.py</code>ã€‚</li>
                <li><strong>æ£€æŸ¥ç‚¹ä¸å®¹é”™ï¼š</strong> è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šå®šæœŸä¿å­˜æ¨¡å‹æ£€æŸ¥ç‚¹åˆ°GCSç­‰å­˜å‚¨ç³»ç»Ÿï¼Œç¡®ä¿é•¿æ—¶é—´è®­ç»ƒä»»åŠ¡çš„ç¨³å®šæ€§å’Œå¯æ¢å¤æ€§ã€‚</li>
                <li><strong>æ··åˆç²¾åº¦è®­ç»ƒï¼š</strong> ä¸ºäº†æå‡è®­ç»ƒæ•ˆç‡å’Œå‡å°‘æ˜¾å­˜å ç”¨ï¼Œé€šå¸¸é‡‡ç”¨bfloat16ç­‰æ··åˆç²¾åº¦è¿›è¡Œè®¡ç®—ã€‚</li>
            </ul>
            <p class="formula">æ¨¡å‹è®­ç»ƒæ ¸å¿ƒå¾ªç¯ (ç®€åŒ–): For each batch: Predictions = Model(Input_Data); Loss = CalculateLoss(Predictions, Targets); Gradients = BackwardPass(Loss); Optimizer.apply_gradients(Gradients)</p>

            <h3>4. å®éªŒæ‰§è¡Œä¸èµ„æºç®¡ç†çš„â€œæŒ‡æŒ¥ä¸­å¿ƒâ€</h3>
            <p><code>marin/execution/executor.py</code>æ˜¯æ•´ä¸ªå·¥ä½œæµçš„è°ƒåº¦æ ¸å¿ƒï¼š</p>
            <ul>
                <li><strong>é…ç½®é©±åŠ¨ï¼š</strong> æ‰§è¡Œå™¨è¯»å–å®éªŒé…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯Pythonè„šæœ¬ï¼Œé€šè¿‡dataclasså®šä¹‰é…ç½®ï¼‰ï¼Œç¡®å®šéœ€è¦æ‰§è¡Œçš„æ­¥éª¤åŠå…¶ä¾èµ–ã€‚</li>
                <li><strong>æ­¥éª¤æ‰§è¡Œï¼š</strong> æŒ‰ç…§æ‹“æ‰‘é¡ºåºæ‰§è¡Œæ•°æ®ä¸‹è½½ã€é¢„å¤„ç†ã€è®­ç»ƒã€è¯„ä¼°ç­‰å„ä¸ªæ­¥éª¤ã€‚æ¯ä¸ªæ­¥éª¤éƒ½æ˜¯ä¸€ä¸ªå¯ç‹¬ç«‹è¿è¡Œçš„å•å…ƒã€‚</li>
                <li><strong>èµ„æºè°ƒåº¦ï¼š</strong> é€šè¿‡<code>marin/resources.py</code>å’Œ<code>infra/</code>ä¸­çš„é›†ç¾¤é…ç½®æ–‡ä»¶ï¼Œæ‰§è¡Œå™¨å¯ä»¥è¯·æ±‚å’Œç®¡ç†è®¡ç®—èµ„æºï¼Œæ”¯æŒæœ¬åœ°æ‰§è¡Œã€å•èŠ‚ç‚¹GPU/TPUä»¥åŠå¤§è§„æ¨¡Rayé›†ç¾¤ï¼ˆGCP TPU Podsï¼‰ã€‚</li>
                <li><strong>æ—¥å¿—ä¸ç›‘æ§ï¼š</strong> æ·±åº¦é›†æˆWandB (Weights & Biases) è¿›è¡Œå®éªŒè·Ÿè¸ªã€æ—¥å¿—è®°å½•å’Œå¯è§†åŒ–ã€‚</li>
            </ul>

            <h3>5. æ¨¡å‹è¯„ä¼°çš„â€œè´¨æ£€ç¯èŠ‚â€</h3>
            <p>è®­ç»ƒå®Œæˆåï¼Œæ¨¡å‹éœ€è¦ç»è¿‡ä¸¥æ ¼çš„è¯„ä¼°ï¼ˆ<code>marin/evaluation/</code>ï¼‰ï¼š</p>
            <ul>
                <li><strong>å¤šåŸºå‡†æ”¯æŒï¼š</strong> é›†æˆäº†å¤šç§è¡Œä¸šæ ‡å‡†è¯„ä¼°å¥—ä»¶ï¼Œå¦‚LM Evaluation Harnessã€HELMã€AlpacaEvalç­‰ï¼Œè¦†ç›–è¯­è¨€ç†è§£ã€ç”Ÿæˆã€æ¨ç†ã€ä»£ç ã€æ•°å­¦ç­‰å¤šä¸ªæ–¹é¢ã€‚</li>
                <li><strong>å¯é…ç½®è¯„ä¼°ä»»åŠ¡ï¼š</strong> ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°é…ç½®è¦è¿è¡Œçš„è¯„ä¼°ä»»åŠ¡å’Œæ•°æ®é›†ã€‚</li>
                <li><strong>ç»“æœæ±‡æ€»ä¸åˆ†æï¼š</strong> è¯„ä¼°ç»“æœä¼šè¢«è®°å½•ï¼Œå¹¶å¯ä»¥é€šè¿‡å·¥å…·ï¼ˆå¦‚<code>marin/evaluation/visualize.py</code>æˆ–Data Browserï¼‰è¿›è¡Œåˆ†æå’Œæ¯”è¾ƒã€‚</li>
            </ul>

            <h3>6. ç¤¾åŒºä¸ç”Ÿæ€ï¼šâ€œä¼—äººæ‹¾æŸ´ç«ç„°é«˜â€</h3>
            <ul>
                <li><strong>å¼€æºä¸è´¡çŒ®ï¼š</strong> é¡¹ç›®é€šè¿‡GitHubå¼€æ”¾æºä»£ç ï¼Œå¹¶æä¾›äº†è¯¦ç»†çš„è´¡çŒ®æŒ‡å—ï¼ˆ<code>CONTRIBUTING.md</code>ï¼‰å’ŒIssueæ¨¡æ¿ï¼Œé¼“åŠ±ç¤¾åŒºå‚ä¸ã€‚</li>
                <li><strong>æ–‡æ¡£ä¸æ•™ç¨‹ï¼š</strong> å®Œå–„çš„æ–‡æ¡£ï¼ˆ<code>docs/</code>ï¼‰é™ä½äº†ä¸Šæ‰‹é—¨æ§›ï¼ŒåŒ…æ‹¬å®‰è£…ã€å¿«é€Ÿå¼€å§‹ã€æ ¸å¿ƒæ¦‚å¿µè§£é‡Šå’Œé«˜çº§æ•™ç¨‹ã€‚</li>
                <li><strong>æ•°æ®æµè§ˆå™¨ï¼ˆData Browserï¼‰ï¼š</strong> <code>data_browser/</code>æä¾›äº†ä¸€ä¸ªWebç•Œé¢ï¼Œæ–¹ä¾¿ç”¨æˆ·æŸ¥çœ‹å’Œåˆ†æå®éªŒæ•°æ®å’Œç»“æœï¼Œå¢å¼ºäº†é€æ˜åº¦å’Œæ˜“ç”¨æ€§ã€‚</li>
                <li><strong>Marin Speedrunï¼š</strong> ä¸€é¡¹æœ‰è¶£çš„ç«èµ›æ´»åŠ¨ï¼Œæ—¨åœ¨æ¿€åŠ±ç¤¾åŒºæ¢ç´¢æ›´é«˜æ•ˆçš„æ¨¡å‹è®­ç»ƒæ–¹æ³•ï¼Œä½“ç°äº†é¡¹ç›®çš„ç ”ç©¶å¯¼å‘å’Œç¤¾åŒºäº’åŠ¨æ€§ã€‚</li>
            </ul>
            <p>é€šè¿‡è¿™ä¸€ç³»åˆ—é€»è¾‘æµç¨‹ï¼ŒMarinæ„å»ºäº†ä¸€ä¸ªä»æ•°æ®åˆ°æ¨¡å‹ã€å†åˆ°è¯„ä¼°çš„å®Œæ•´é—­ç¯ï¼ŒåŒæ—¶å¼ºè°ƒäº†è¿‡ç¨‹çš„é€æ˜åŒ–ã€æ ‡å‡†åŒ–å’Œå¯å¤ç°æ€§ï¼Œä¸ºåŸºç¡€æ¨¡å‹çš„ç ”ç©¶å’Œå¼€å‘æä¾›äº†å¼ºå¤§çš„æ”¯æ’‘å¹³å°ã€‚</p>
        </section>

        <section id="animations-section">
            <h2><span class="highlight">ğŸ¬</span> æ ¸å¿ƒåŠ¨ç”»æ¼”ç¤ºï¼šè®© Marin çš„é€»è¾‘åŠ¨èµ·æ¥ï¼</h2>
            <p>ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£Mariné¡¹ç›®çš„æ ¸å¿ƒå·¥ä½œæµç¨‹å’Œæ¶æ„ï¼Œæˆ‘ä»¬å‡†å¤‡äº†ä»¥ä¸‹äº¤äº’å¼åŠ¨ç”»ã€‚ç‚¹å‡»æ’­æ”¾æŒ‰é’®ï¼Œè§‚å¯Ÿæ•°æ®å’Œä»»åŠ¡å¦‚ä½•åœ¨Marinæ¡†æ¶ä¸­æµè½¬å’Œå¤„ç†ã€‚</p>

            <div class="animation-container">
                <h4>åŠ¨ç”»1: Marin æ•°æ®å¤„ç†æµæ°´çº¿ (æ¦‚å¿µæµç¨‹)</h4>
                <div id="dataPipelineCanvasContainer"></div>
                <button onclick="dataPipelineSketch.resetAnimation()">é‡ç½®</button>
                <button onclick="dataPipelineSketch.togglePlay()">æ’­æ”¾/æš‚åœ</button>
            </div>

            <div class="animation-container">
                <h4>åŠ¨ç”»2: Marin åˆ†å¸ƒå¼è®­ç»ƒæ¶æ„ (æ¦‚å¿µå›¾)</h4>
                <div id="distributedTrainingCanvasContainer"></div>
                <button onclick="distributedTrainingSketch.resetAnimation()">é‡ç½®</button>
                <button onclick="distributedTrainingSketch.togglePlay()">æ’­æ”¾/æš‚åœ</button>
            </div>

            <div class="animation-container">
                <h4>åŠ¨ç”»3: Marin æ‰§è¡Œå™¨ (Executor) å·¥ä½œæµ</h4>
                <div id="executorWorkflowCanvasContainer"></div>
                <button onclick="executorWorkflowSketch.resetAnimation()">é‡ç½®</button>
                <button onclick="executorWorkflowSketch.togglePlay()">æ’­æ”¾/æš‚åœ</button>
            </div>
            
            <div class="animation-container">
                <h4>åŠ¨ç”»4: HTML åˆ° Markdown è½¬æ¢ (ç®€åŒ–æ¼”ç¤º)</h4>
                <div id="markdownConversionCanvasContainer"></div>
                <button onclick="markdownConversionSketch.triggerConversion()">è½¬æ¢</button>
            </div>

            <div class="animation-container">
                <h4>åŠ¨ç”»5: æ¨¡å‹è®­ç»ƒå¾ªç¯ (æ¦‚å¿µåŠ¨ç”»)</h4>
                <div id="modelTrainingLoopCanvasContainer"></div>
                <button onclick="modelTrainingLoopSketch.resetAnimation()">é‡ç½®</button>
                <button onclick="modelTrainingLoopSketch.togglePlay()">æ’­æ”¾/æš‚åœ</button>
            </div>
        </section>

        <section id="conclusion">
            <h2><span class="highlight">ğŸ</span> æ€»ç»“ä¸å±•æœ›ï¼šMarin çš„èˆªç¨‹å°†é©¶å‘ä½•æ–¹ï¼Ÿ</h2>
            <p>Mariné¡¹ç›®ä¸ä»…ä»…æ˜¯ä¸€ä¸ªå·¥å…·é›†ï¼Œå®ƒæ›´åƒæ˜¯ä¸€ä¸ª<strong class="highlight">ç²¾å¿ƒæ„å»ºçš„ç”Ÿæ€ç³»ç»Ÿ</strong>ï¼Œæ—¨åœ¨æ¨åŠ¨åŸºç¡€æ¨¡å‹ç ”ç©¶çš„è¾¹ç•Œã€‚ä»å…¶ç‰©ç†ç»“æ„æ¥çœ‹ï¼Œæ¨¡å—åŒ–çš„è®¾è®¡ã€å¯¹å…ˆè¿›åŸºç¡€è®¾æ–½ï¼ˆå¦‚TPUã€Rayé›†ç¾¤ï¼‰çš„æ”¯æŒï¼Œä»¥åŠå®Œå–„çš„æµ‹è¯•å’ŒCI/CDæµç¨‹ï¼Œéƒ½ä½“ç°äº†å…¶å·¥ç¨‹ä¸Šçš„ä¸¥è°¨æ€§ã€‚ä»é€»è¾‘æµç¨‹æ¥çœ‹ï¼Œå¯¹æ•°æ®å…¨ç”Ÿå‘½å‘¨æœŸçš„ç²¾ç»†ç®¡ç†ã€ä»¥å¯å¤ç°æ€§ä¸ºæ ¸å¿ƒçš„å®éªŒæœºåˆ¶ã€ä»¥åŠå…¨é¢çš„æ¨¡å‹è¯„ä¼°æ¡†æ¶ï¼Œåˆ™å½°æ˜¾äº†å…¶ç§‘ç ”ä¸Šçš„è¿œè§ã€‚</p>
            <p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>
            <ul>
                <li><strong class="highlight">ç«¯åˆ°ç«¯çš„å¯å¤ç°æ€§ï¼š</strong> è¿™æ˜¯Marinæœ€çªå‡ºçš„ç‰¹ç‚¹ï¼Œç¡®ä¿äº†ç ”ç©¶çš„å¯é æ€§å’Œé€æ˜åº¦ã€‚</li>
                <li><strong>å¼ºå¤§çš„æ•°æ®å¤„ç†èƒ½åŠ›ï¼š</strong> ç‰¹åˆ«æ˜¯å…¶HTMLåˆ°Markdownçš„è½¬æ¢å’Œâ€œDatashopâ€æ¦‚å¿µï¼Œä¸ºé«˜è´¨é‡æ•°æ®è·å–å’Œç®¡ç†æä¾›äº†æœ‰åŠ›æ”¯æŒã€‚</li>
                <li><strong>å¯æ‰©å±•çš„è®­ç»ƒä¸è¯„ä¼°ï¼š</strong> èƒ½å¤Ÿé€‚åº”ä»å°å‹å®éªŒåˆ°å¤§è§„æ¨¡æ¨¡å‹è®­ç»ƒçš„å„ç§éœ€æ±‚ã€‚</li>
                <li><strong>å¼€æ”¾çš„ç¤¾åŒºç”Ÿæ€ï¼š</strong> é¼“åŠ±åä½œå’ŒçŸ¥è¯†å…±äº«ï¼Œæœ‰åŠ©äºåŠ é€Ÿåˆ›æ–°ã€‚</li>
            </ul>
            <p><strong>æœªæ¥å±•æœ›ï¼š</strong></p>
            <p>éšç€å¤§æ¨¡å‹æŠ€æœ¯çš„é£é€Ÿå‘å±•ï¼ŒMarinè¿™æ ·çš„æ¡†æ¶å°†æ‰®æ¼”è¶Šæ¥è¶Šé‡è¦çš„è§’è‰²ã€‚æœªæ¥ï¼ŒMarinå¯èƒ½ä¼šåœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ç»§ç»­æ·±åŒ–å’Œæ‹“å±•ï¼š</p>
            <ul>
                <li><strong>æ›´å¤šæ¨¡æ€çš„æ”¯æŒï¼š</strong> å½“å‰ä¸»è¦èšç„¦æ–‡æœ¬ï¼Œæœªæ¥å¯èƒ½æ‰©å±•åˆ°å›¾åƒã€éŸ³é¢‘ç­‰å¤šæ¨¡æ€æ•°æ®çš„å¤„ç†å’Œå»ºæ¨¡ã€‚</li>
                <li><strong>æ›´æ™ºèƒ½çš„æ•°æ®ç®¡çº¿ï¼š</strong> å¼•å…¥æ›´å¤šè‡ªåŠ¨åŒ–å’ŒAIé©±åŠ¨çš„æ•°æ®ç­›é€‰ã€å¢å¼ºå’ŒåˆæˆæŠ€æœ¯ã€‚</li>
                <li><strong>æ›´å…ˆè¿›çš„æ¨¡å‹æ¶æ„ä¸è®­ç»ƒæŠ€æœ¯ï¼š</strong> æŒç»­è·Ÿè¿›å¹¶é›†æˆæœ€æ–°çš„æ¨¡å‹è®¾è®¡ï¼ˆå¦‚æ›´é«˜æ•ˆçš„æ³¨æ„åŠ›æœºåˆ¶ã€ç¨€ç–æ¨¡å‹ç­‰ï¼‰å’Œè®­ç»ƒæ–¹æ³•ï¼ˆå¦‚æ–°çš„ä¼˜åŒ–ç®—æ³•ã€æ›´é«˜æ•ˆçš„å¹¶è¡Œç­–ç•¥ï¼‰ã€‚</li>
                <li><strong>æ›´ä¾¿æ·çš„éƒ¨ç½²ä¸æ¨ç†ï¼š</strong> æä¾›æ›´å®Œå–„çš„æ¨¡å‹å¯¼å‡ºã€å‹ç¼©å’Œéƒ¨ç½²å·¥å…·é“¾ï¼Œæ–¹ä¾¿ç ”ç©¶æˆæœçš„å®é™…åº”ç”¨ã€‚</li>
                <li><strong>æ›´æ´»è·ƒçš„ç¤¾åŒºä¸ç”Ÿæ€å»ºè®¾ï¼š</strong> é€šè¿‡ä¸¾åŠæ›´å¤šç±»ä¼¼â€œSpeedrunâ€çš„æ´»åŠ¨ï¼Œå¸å¼•æ›´å¤šå¼€å‘è€…å’Œç ”ç©¶è€…åŠ å…¥ï¼Œå…±åŒæ„å»ºæ›´ä¸°å¯Œçš„æ•°æ®é›†ã€æ¨¡å‹åº“å’Œå·¥å…·ã€‚</li>
            </ul>
            <p>æ€»è€Œè¨€ä¹‹ï¼ŒMariné¡¹ç›®ä¸ºåŸºç¡€æ¨¡å‹çš„ç ”ç©¶å’Œå¼€å‘æä¾›äº†ä¸€ä¸ªåšå®ä¸”å……æ»¡æ´»åŠ›çš„å¹³å°ã€‚å®ƒä¸ä»…ä»…æ˜¯åœ¨â€œé€ èˆ¹â€ï¼Œæ›´æ˜¯åœ¨åŸ¹å…»èƒ½å¤Ÿé©¾é©­è¿™äº›â€œèˆ¹åªâ€çš„â€œæ°´æ‰‹â€ï¼Œå…±åŒæ¢ç´¢äººå·¥æ™ºèƒ½è¿™ç‰‡å¹¿é˜”çš„æœªçŸ¥æ°´åŸŸã€‚å¯¹äºä»»ä½•å¸Œæœ›æ·±å…¥ç ”ç©¶åŸºç¡€æ¨¡å‹ã€å¹¶é‡è§†è¿‡ç¨‹é€æ˜åº¦å’Œç»“æœå¯å¤ç°æ€§çš„å›¢é˜Ÿæˆ–ä¸ªäººè€Œè¨€ï¼ŒMarinæ— ç–‘æ˜¯ä¸€ä¸ªå€¼å¾—å…³æ³¨å’ŒæŠ•å…¥çš„å®è´µèµ„æºã€‚</p>
        </section>

        <footer>
            <p>Marin é¡¹ç›®åˆ†ææŠ¥å‘Š | ç”Ÿæˆæ—¶é—´: <span id="generationTime"></span></p>
        </footer>
    </div>

    <script>
        // --- Animation 1: Data Processing Pipeline ---
        let dataPipelineSketch; // Will hold the p5 instance
        const dataPipelineAnimation = (p) => {
            let nodes = [];
            let edges = [];
            let progress = 0;
            let maxProgress = 600;
            let playing = false;
            let nodeSize = 60;
            let colors;

            p.setup = () => {
                const container = document.getElementById('dataPipelineCanvasContainer');
                let canvas = p.createCanvas(container.offsetWidth, container.offsetHeight);
                canvas.parent('dataPipelineCanvasContainer');
                p.textAlign(p.CENTER, p.CENTER);
                p.textSize(10);
                colors = {
                    bg: p.color(250, 250, 250),
                    node: p.color(74, 144, 226, 200), // Blueish
                    nodeText: p.color(255),
                    processedNode: p.color(80, 227, 194, 220), // Greenish
                    edge: p.color(150),
                    activeEdge: p.color(230, 126, 34) // Orange
                };
                initializeElements();
                p.noLoop(); // Start paused
                p.redraw();
            };
            
            p.windowResized = () => {
                const container = document.getElementById('dataPipelineCanvasContainer');
                p.resizeCanvas(container.offsetWidth, container.offsetHeight);
                initializeElements(); // Re-initialize to adjust positions for responsiveness
                p.redraw();
            };

            function initializeElements() {
                // Adjust node positions based on current canvas size
                nodes = [
                    { id: 0, label: "åŸå§‹æ•°æ®\n(Web, ArXiv)", x: p.width * 0.15, y: p.height * 0.3, active: false },
                    { id: 1, label: "çˆ¬å–/ä¸‹è½½", x: p.width * 0.15, y: p.height * 0.7, active: false },
                    { id: 2, label: "HTML->MD\næ¸…æ´—è¿‡æ»¤", x: p.width * 0.4, y: p.height * 0.5, active: false },
                    { id: 3, label: "è¯å…ƒåŒ–", x: p.width * 0.65, y: p.height * 0.3, active: false },
                    { id: 4, label: "Marinæ•°æ®é›†", x: p.width * 0.65, y: p.height * 0.7, active: false },
                    { id: 5, label: "æœ€ç»ˆæ¨¡å‹\nå¯ä½¿ç”¨æ•°æ®", x: p.width * 0.9, y: p.height * 0.5, active: false }
                ];
                edges = [ // Edges remain the same logically
                    { from: 0, to: 1, stage: 0 }, { from: 1, to: 2, stage: 100 },
                    { from: 2, to: 3, stage: 200 }, { from: 2, to: 4, stage: 200 }, 
                    { from: 3, to: 5, stage: 300 }, { from: 4, to: 5, stage: 400 }
                ];
                 nodeSize = p.min(p.width * 0.1, p.height * 0.15, 60); // Responsive node size
                 p.textSize(p.max(8, nodeSize / 6)); // Responsive text size
            }

            p.draw = () => {
                p.background(colors.bg);
                if (playing) {
                    progress += 2;
                    if (progress > maxProgress) progress = 0;
                }

                p.strokeWeight(2);
                for (let edge of edges) {
                    let n1 = nodes.find(n => n.id === edge.from);
                    let n2 = nodes.find(n => n.id === edge.to);
                    if (progress > edge.stage && progress < edge.stage + 100) {
                        p.stroke(colors.activeEdge);
                    } else {
                        p.stroke(colors.edge);
                    }
                    p.line(n1.x, n1.y, n2.x, n2.y);
                }

                for (let node of nodes) {
                    let isActive = (progress > (edges.find(e => e.to === node.id)?.stage || -1) || (node.id === 0 && progress >=0));
                    p.fill(isActive ? colors.processedNode : colors.node);
                    p.noStroke();
                    p.ellipse(node.x, node.y, nodeSize, nodeSize);
                    p.fill(colors.nodeText);
                    p.text(node.label, node.x, node.y);
                }
            };

            p.resetAnimation = () => { // Attached to p (p5 instance)
                progress = 0;
                playing = false;
                p.noLoop();
                p.redraw();
            };
            p.togglePlay = () => { // Attached to p (p5 instance)
                playing = !playing;
                if (playing) p.loop(); else p.noLoop();
            };
        };

        // --- Animation 2: Distributed Training Architecture ---
        let distributedTrainingSketch; // Will hold the p5 instance
        const distributedTrainingAnimation = (p) => {
            let elements = {};
            let connections = [];
            let time = 0;
            let playing = false;
            let colors;

            p.setup = () => {
                const container = document.getElementById('distributedTrainingCanvasContainer');
                let canvas = p.createCanvas(container.offsetWidth, container.offsetHeight);
                canvas.parent('distributedTrainingCanvasContainer');
                colors = {
                    bg: p.color(250, 250, 250),
                    executor: p.color(217, 83, 79, 200), 
                    rayHead: p.color(240, 173, 78, 200), 
                    rayWorker: p.color(92, 184, 92, 200), 
                    data: p.color(74, 144, 226, 200), 
                    text: p.color(50),
                    arrow: p.color(100)
                };
                initializeElements();
                p.noLoop();
                p.redraw();
            };
            
            p.windowResized = () => {
                const container = document.getElementById('distributedTrainingCanvasContainer');
                p.resizeCanvas(container.offsetWidth, container.offsetHeight);
                initializeElements(); 
                p.redraw();
            };

            function initializeElements() {
                let w = p.width;
                let h = p.height;
                let elW = p.max(80, w * 0.18); // Responsive width
                let elH = p.max(35, h * 0.08); // Responsive height
                let workerH = p.max(40, h*0.1);

                elements = {
                    config: { label: "å®éªŒé…ç½®", x: w * 0.1, y: h * 0.15, w: elW, h: elH, type: 'executor' },
                    executor: { label: "Marinæ‰§è¡Œå™¨", x: w * 0.1, y: h * 0.45, w: elW, h: elH, type: 'executor' },
                    rayHead: { label: "Ray Head", x: w * 0.5, y: h * 0.15, w: elW, h: elH, type: 'rayHead' },
                    worker1: { label: "Worker\n(TPU/GPU)", x: w * 0.35, y: h * 0.65, w: elW * 1.1, h: workerH, type: 'rayWorker' },
                    worker2: { label: "Worker\n(TPU/GPU)", x: w * 0.65, y: h * 0.65, w: elW * 1.1, h: workerH, type: 'rayWorker' },
                    dataStore: { label: "æ•°æ®å­˜å‚¨\n(GCS)", x: w * 0.85, y: h * 0.25, w: elW*1.1, h: workerH, type: 'data' },
                    checkpoints: { label: "æ¨¡å‹æ£€æŸ¥ç‚¹", x: w * 0.85, y: h * 0.65, w: elW, h: elH, type: 'data' }
                };
                connections = [
                    { from: 'config', to: 'executor', type: 'control' },
                    { from: 'executor', to: 'rayHead', type: 'control' },
                    { from: 'rayHead', to: 'worker1', type: 'task' },
                    { from: 'rayHead', to: 'worker2', type: 'task' },
                    { from: 'dataStore', to: 'worker1', type: 'data_flow' },
                    { from: 'dataStore', to: 'worker2', type: 'data_flow' },
                    { from: 'worker1', to: 'checkpoints', type: 'data_flow' },
                    { from: 'worker2', to: 'checkpoints', type: 'data_flow' },
                    { from: 'worker1', to: 'rayHead', type: 'gradient_sync', dashed: true }, 
                    { from: 'worker2', to: 'rayHead', type: 'gradient_sync', dashed: true }
                ];
                 p.textSize(p.max(8, elW / 10));
            }

            p.draw = () => {
                p.background(colors.bg);
                p.textAlign(p.CENTER, p.CENTER);
                
                for (let conn of connections) {
                    let e1 = elements[conn.from];
                    let e2 = elements[conn.to];
                    p.stroke(colors.arrow);
                    p.strokeWeight(1.5);
                    if (conn.dashed) p.drawingContext.setLineDash([5, 5]);
                    else p.drawingContext.setLineDash([]);
                    drawArrow(e1.x + e1.w / 2, e1.y + e1.h / 2, e2.x + e2.w / 2, e2.y + e2.h / 2, p);

                    if (playing && time % 150 > 50 && time % 150 < 100) {
                        if ((conn.type === 'task' && (time/150) % connections.length < connections.indexOf(conn) + 1) ||
                            (conn.type === 'data_flow' && (time/200) % connections.length < connections.indexOf(conn) + 1)) {
                            let packetX = p.lerp(e1.x + e1.w/2, e2.x + e2.w/2, (time % 50) / 50);
                            let packetY = p.lerp(e1.y + e1.h/2, e2.y + e2.h/2, (time % 50) / 50);
                            p.fill(conn.type === 'task' ? colors.rayHead : colors.data);
                            p.noStroke();
                            p.ellipse(packetX, packetY, 8, 8);
                        }
                    }
                }
                p.drawingContext.setLineDash([]); 

                for (let key in elements) {
                    let el = elements[key];
                    p.fill(colors[el.type]);
                    p.noStroke();
                    p.rect(el.x, el.y, el.w, el.h, 5); 
                    p.fill(colors.text);
                    p.text(el.label, el.x + el.w / 2, el.y + el.h / 2);
                }
                if (playing) time++;
            };
            
            function drawArrow(x1, y1, x2, y2, pg) {
                pg.line(x1, y1, x2, y2);
                let angle = pg.atan2(y2 - y1, x2 - x1);
                pg.push();
                pg.translate(x2, y2);
                pg.rotate(angle);
                pg.fill(colors.arrow);
                pg.triangle(0, 0, -8, -4, -8, 4);
                pg.pop();
            }

            p.resetAnimation = () => { time = 0; playing = false; p.noLoop(); p.redraw(); };
            p.togglePlay = () => { playing = !playing; if(playing) p.loop(); else p.noLoop(); };
        };
        
        // --- Animation 3: Executor Workflow ---
        let executorWorkflowSketch; // Will hold the p5 instance
        const executorWorkflowAnimation = (p) => {
            let stages = [];
            let currentStage = -1;
            let playing = false;
            let colors;
            let stageHeight, stageWidth, spacing;

            p.setup = () => {
                const container = document.getElementById('executorWorkflowCanvasContainer');
                let canvas = p.createCanvas(container.offsetWidth, container.offsetHeight);
                canvas.parent('executorWorkflowCanvasContainer');
                colors = {
                    bg: p.color(250, 250, 250),
                    stageDefault: p.color(100, 180, 220, 180),
                    stageActive: p.color(80, 227, 194, 220),
                    stageDone: p.color(150, 150, 150, 180),
                    text: p.color(20),
                    arrow: p.color(80)
                };
                initializeStages();
                p.noLoop();
                p.redraw();
            };

            p.windowResized = () => {
                const container = document.getElementById('executorWorkflowCanvasContainer');
                p.resizeCanvas(container.offsetWidth, container.offsetHeight);
                initializeStages();
                p.redraw();
            };
            
            function initializeStages() {
                stages = [
                    "åŠ è½½å®éªŒé…ç½®", "åˆå§‹åŒ–Rayé›†ç¾¤", "æ£€æŸ¥ä¾èµ–", "åˆ†é…èµ„æº", 
                    "æ‰§è¡Œæ­¥éª¤\n(ä¸‹è½½/å¤„ç†/è®­ç»ƒ/è¯„ä¼°)", "è®°å½•æ—¥å¿— (W&B)", "å­˜å‚¨äº§ç‰© (GCS)"
                ];
                stageHeight = p.height * 0.11; // Adjusted for more stages
                stageWidth = p.width * 0.85; // Adjusted for better fit
                spacing = p.height * 0.025; // Adjusted spacing
                currentStage = -1; 
                 p.textSize(p.max(8, stageHeight / 4)); // Responsive text
            }

            p.draw = () => {
                p.background(colors.bg);
                p.textAlign(p.CENTER, p.CENTER);
                
                if (playing && p.frameCount % 30 === 0) { 
                    currentStage = (currentStage + 1);
                    if (currentStage >= stages.length) { // Stop at the end
                        playing = false;
                        p.noLoop();
                    }
                }
                
                let totalHeight = stages.length * stageHeight + (stages.length - 1) * spacing;
                let startY = (p.height - totalHeight) / 2 + stageHeight / 2;


                for (let i = 0; i < stages.length; i++) {
                    let x = p.width / 2;
                    let y = startY + i * (stageHeight + spacing);
                    
                    if (i < currentStage) p.fill(colors.stageDone);
                    else if (i === currentStage) p.fill(colors.stageActive);
                    else p.fill(colors.stageDefault);
                    
                    p.noStroke();
                    p.rectMode(p.CENTER);
                    p.rect(x, y, stageWidth, stageHeight, 8);
                    p.fill(colors.text);
                    p.text(stages[i], x, y);

                    if (i < stages.length - 1) {
                        p.stroke(colors.arrow);
                        p.strokeWeight(2);
                        drawArrow(x, y + stageHeight / 2 + 2, x, y + stageHeight / 2 + spacing -2, p, 5);
                    }
                }
            };
            
            function drawArrow(x1, y1, x2, y2, pg, arrowSize) {
                pg.line(x1, y1, x2, y2);
                let angle = pg.atan2(y2 - y1, x2 - x1);
                pg.push();
                pg.translate(x2, y2);
                pg.rotate(angle);
                pg.fill(colors.arrow);
                pg.triangle(0, 0, -arrowSize, -arrowSize/2, -arrowSize, arrowSize/2);
                pg.pop();
            }

            p.resetAnimation = () => { currentStage = -1; playing = false; p.noLoop(); p.redraw(); };
            p.togglePlay = () => { 
                playing = !playing; 
                if (playing) {
                    if(currentStage >= stages.length -1 ) currentStage = -1; 
                    p.loop(); 
                } else {
                    p.noLoop();
                }
            };
        };

        // --- Animation 4: HTML to Markdown Conversion ---
        let markdownConversionSketch; // Will hold the p5 instance
        const markdownConversionAnimation = (p) => {
            let htmlText = "<h1>æ ‡é¢˜</h1>\n<p>ä¸€äº›<b>åŠ ç²—</b>æ–‡æœ¬å’Œ<i>æ–œä½“</i>æ–‡å­—ã€‚</p>\n<ul><li>åˆ—è¡¨é¡¹1</li><li>åˆ—è¡¨é¡¹2</li></ul>";
            let mdText = "# æ ‡é¢˜\n\nä¸€äº›**åŠ ç²—**æ–‡æœ¬å’Œ*æ–œä½“*æ–‡å­—ã€‚\n\n- åˆ—è¡¨é¡¹1\n- åˆ—è¡¨é¡¹2";
            let displayText = "";
            let converting = false;
            let conversionProgress = 0;
            let colors;

            p.setup = () => {
                const container = document.getElementById('markdownConversionCanvasContainer');
                let canvas = p.createCanvas(container.offsetWidth, container.offsetHeight);
                canvas.parent('markdownConversionCanvasContainer');
                colors = {
                    bg: p.color(250, 250, 250),
                    text: p.color(50),
                    boxBg: p.color(230, 230, 230, 220),
                    arrow: p.color(74, 144, 226)
                };
                displayText = htmlText;
                p.textAlign(p.LEFT, p.TOP);
                p.noLoop();
                p.redraw();
            };

            p.windowResized = () => {
                const container = document.getElementById('markdownConversionCanvasContainer');
                p.resizeCanvas(container.offsetWidth, container.offsetHeight);
                p.redraw();
            };

            p.draw = () => {
                p.background(colors.bg);
                let boxWidth = p.width * 0.42; // Adjusted width
                let boxHeight = p.height * 0.75; // Adjusted height
                let boxY = p.height * 0.125;
                let padding = p.width * 0.02; // Responsive padding
                p.textSize(p.max(10, p.width * 0.025)); // Responsive text size


                // HTML Box
                p.fill(colors.boxBg);
                p.noStroke();
                p.rect(p.width * 0.05, boxY, boxWidth, boxHeight, 8);
                p.fill(colors.text);
                p.text("HTML è¾“å…¥:", p.width * 0.05 + padding, boxY + padding * 0.5);
                p.text(displayText, p.width * 0.05 + padding, boxY + padding * 2.5, boxWidth - 2 * padding, boxHeight - 3 * padding);

                // Markdown Box
                p.fill(colors.boxBg);
                p.rect(p.width * 0.53, boxY, boxWidth, boxHeight, 8); // Adjusted X position
                p.fill(colors.text);
                p.text("Markdown è¾“å‡º:", p.width * 0.53 + padding, boxY + padding * 0.5);
                p.text(displayText === mdText ? mdText : (converting && conversionProgress >= 0.95 ? mdText : ""), p.width * 0.53 + padding, boxY + padding * 2.5, boxWidth - 2 * padding, boxHeight - 3 * padding);

                // Arrow
                let arrowStartX = p.width * 0.05 + boxWidth + p.width*0.01;
                let arrowEndX = p.width * 0.53 - p.width*0.01;
                let arrowY = p.height / 2;
                
                p.stroke(colors.arrow);
                p.strokeWeight(3);
                p.line(arrowStartX, arrowY, arrowEndX, arrowY);
                p.fill(colors.arrow);
                p.triangle(arrowEndX, arrowY, arrowEndX - 10, arrowY - 5, arrowEndX - 10, arrowY + 5);

                if (converting) {
                    conversionProgress += 0.02; // Speed of conversion
                    let interpX = p.lerp(arrowStartX, arrowEndX, conversionProgress);
                    p.fill(230, 126, 34); 
                    p.noStroke();
                    p.ellipse(interpX, arrowY, 15, 15);
                    p.fill(colors.text);
                    p.textAlign(p.CENTER, p.CENTER);
                    p.text("è½¬æ¢ä¸­...", p.width * 0.5, arrowY - 25);
                    p.textAlign(p.LEFT, p.TOP); // Reset alignment

                    if (conversionProgress >= 1) {
                        converting = false;
                        conversionProgress = 0;
                        displayText = mdText;
                        p.noLoop(); 
                    }
                    p.redraw(); 
                }
            };

            p.triggerConversion = () => { // Attached to p (p5 instance)
                if (!converting) {
                    displayText = htmlText; 
                    converting = true;
                    conversionProgress = 0;
                    p.loop();
                }
            };
        };
        
        // --- Animation 5: Model Training Loop ---
        let modelTrainingLoopSketch; // Will hold the p5 instance
        const modelTrainingLoopAnimation = (p) => {
            let elements = {};
            let dataPacket = { x: 0, y: 0, active: false, progress: 0 };
            let lossValue = 1.0;
            let iteration = 0;
            let playing = false;
            let colors;
            let phase = 0; 

            p.setup = () => {
                const container = document.getElementById('modelTrainingLoopCanvasContainer');
                let canvas = p.createCanvas(container.offsetWidth, container.offsetHeight);
                canvas.parent('modelTrainingLoopCanvasContainer');
                colors = {
                    bg: p.color(250, 250, 250),
                    data: p.color(52, 152, 219),
                    model: p.color(46, 204, 113),
                    loss: p.color(231, 76, 60),
                    optimizer: p.color(241, 196, 15),
                    text: p.color(50),
                    packet: p.color(230,126,34)
                };
                initializeElements();
                p.textAlign(p.CENTER, p.CENTER);
                p.noLoop();
                p.redraw();
            };

            p.windowResized = () => {
                const container = document.getElementById('modelTrainingLoopCanvasContainer');
                p.resizeCanvas(container.offsetWidth, container.offsetHeight);
                initializeElements();
                p.redraw();
            };

            function initializeElements() {
                let w = p.width;
                let h = p.height;
                let elSize = p.min(w * 0.22, h * 0.22); 
                p.textSize(p.max(8, elSize / 7));

                elements = {
                    data: { label: "è¾“å…¥æ•°æ®\næ‰¹æ¬¡", x: w * 0.2, y: h * 0.3, size: elSize, color: colors.data },
                    model: { label: "æ¨¡å‹\n(Transformer)", x: w * 0.5, y: h * 0.5, size: elSize * 1.1, color: colors.model },
                    loss: { label: "æŸå¤±å‡½æ•°", x: w * 0.8, y: h * 0.3, size: elSize, color: colors.loss },
                    optimizer: { label: "ä¼˜åŒ–å™¨\n(AdamW)", x: w * 0.5, y: h * 0.75, size: elSize, color: colors.optimizer }
                };
                resetPacket();
            }
            
            function resetPacket() {
                dataPacket.x = elements.data.x;
                dataPacket.y = elements.data.y;
                dataPacket.active = false;
                dataPacket.progress = 0;
            }


            p.draw = () => {
                p.background(colors.bg);

                for (let key in elements) {
                    let el = elements[key];
                    p.fill(el.color);
                    p.noStroke();
                    p.ellipse(el.x, el.y, el.size, el.size);
                    p.fill(colors.text);
                    p.text(el.label, el.x, el.y);
                }

                p.stroke(150);
                p.strokeWeight(2);
                drawArrow(elements.data.x, elements.data.y, elements.model.x, elements.model.y, p, 10);
                drawArrow(elements.model.x, elements.model.y, elements.loss.x, elements.loss.y, p, 10);
                drawArrow(elements.loss.x, elements.loss.y, elements.optimizer.x, elements.optimizer.y, p, 10);
                drawArrow(elements.optimizer.x, elements.optimizer.y, elements.model.x, elements.model.y, p, 10);


                if (playing) {
                    dataPacket.progress += 0.03;
                    if (dataPacket.progress >= 1) {
                        dataPacket.progress = 0;
                        phase = (phase + 1) % 4;
                        if (phase === 0) { 
                            iteration++;
                            lossValue = p.max(0.05, lossValue * (0.92 - p.random(0.03))); 
                        }
                    }
                    
                    let startEl, endEl;
                    switch(phase) {
                        case 0: startEl = elements.data; endEl = elements.model; break; 
                        case 1: startEl = elements.model; endEl = elements.loss; break; 
                        case 2: startEl = elements.loss; endEl = elements.optimizer; break; 
                        case 3: startEl = elements.optimizer; endEl = elements.model; break; 
                    }
                    dataPacket.x = p.lerp(startEl.x, endEl.x, dataPacket.progress);
                    dataPacket.y = p.lerp(startEl.y, endEl.y, dataPacket.progress);
                    dataPacket.active = true;
                }
                
                if(dataPacket.active){
                    p.fill(colors.packet);
                    p.noStroke();
                    p.ellipse(dataPacket.x, dataPacket.y, p.max(10, elSize/10) , p.max(10, elSize/10));
                }

                p.fill(colors.text);
                p.textSize(p.max(10, p.width * 0.03));
                p.textAlign(p.RIGHT, p.TOP);
                p.text(`è¿­ä»£: ${iteration}`, p.width - 20, 20);
                p.text(`æŸå¤±: ${lossValue.toFixed(3)}`, p.width - 20, 20 + p.max(12, p.width * 0.035));
                p.textAlign(p.CENTER, p.CENTER); 
                p.textSize(p.max(8, elements.data.size / 7)); // Reset default text size
            };
            
            function drawArrow(x1, y1, x2, y2, pg, arrowSize) {
                pg.line(x1, y1, x2, y2);
                let angle = pg.atan2(y2 - y1, x2 - x1);
                pg.push();
                pg.translate(x2, y2);
                pg.rotate(angle);
                pg.fill(colors.arrow);
                pg.triangle(0, 0, -arrowSize, -arrowSize/2, -arrowSize, arrowSize/2);
                pg.pop();
            }

            p.resetAnimation = () => { // Attached to p (p5 instance)
                iteration = 0; lossValue = 1.0; phase = 0; 
                resetPacket();
                playing = false; p.noLoop(); p.redraw();
            };
            p.togglePlay = () => { // Attached to p (p5 instance)
                playing = !playing;
                if(playing) {
                    if (!dataPacket.active && phase === 0 && dataPacket.progress === 0) { // Start packet if fresh start
                         dataPacket.active = true;
                    }
                     p.loop();
                } else {
                     p.noLoop();
                }
            };
        };

        // Initialize P5 sketches
        document.addEventListener('DOMContentLoaded', () => {
            dataPipelineSketch = new p5(dataPipelineAnimation, 'dataPipelineCanvasContainer');
            distributedTrainingSketch = new p5(distributedTrainingAnimation, 'distributedTrainingCanvasContainer');
            executorWorkflowSketch = new p5(executorWorkflowAnimation, 'executorWorkflowCanvasContainer');
            markdownConversionSketch = new p5(markdownConversionAnimation, 'markdownConversionCanvasContainer');
            modelTrainingLoopSketch = new p5(modelTrainingLoopAnimation, 'modelTrainingLoopCanvasContainer');
            
            document.getElementById('generationTime').textContent = new Date().toLocaleString('zh-CN');

            window.addEventListener('resize', () => {
                if (dataPipelineSketch && typeof dataPipelineSketch.windowResized === 'function') dataPipelineSketch.windowResized();
                if (distributedTrainingSketch && typeof distributedTrainingSketch.windowResized === 'function') distributedTrainingSketch.windowResized();
                if (executorWorkflowSketch && typeof executorWorkflowSketch.windowResized === 'function') executorWorkflowSketch.windowResized();
                if (markdownConversionSketch && typeof markdownConversionSketch.windowResized === 'function') markdownConversionSketch.windowResized();
                if (modelTrainingLoopSketch && typeof modelTrainingLoopSketch.windowResized === 'function') modelTrainingLoopSketch.windowResized();
            });
        });
    </script>
</body>
</html>
